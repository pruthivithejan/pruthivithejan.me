---
import {getCollection, type CollectionEntry } from "astro:content"
// component imports
import Main from "@/layout/main.astro";
import PostCard from "@/components/blog/postCard.astro";
// utils
import { slugify, formatBlogPosts} from "@/lib/utils";
import categories from "@/data/categories";

export async function getStaticPaths() {
 return categories.map(category => ({
    params: { category: category.slug },
    props: { name: category.name },
 }));
}
const { category } = Astro.params;
const { name } = Astro.props;
const allPosts = await getCollection("blog");
const formattedPosts: CollectionEntry<"blog">[] = formatBlogPosts(allPosts);
const catPosts = formattedPosts.filter(
  (post) => slugify(post.data.category) === category
);
---

<Main title={name}>
  <section class="mt-24 text-white font-body min-h-screen" aria-label={`Posts about ${name}`}>
    <h1
    class="text-center text-neutral-50 text-3xl font-bold leading-tight tracking-tighter md:text-6xl lg:leading-[1.1] hidden md:block animate-enter"
  >
  Posts about <span class="font-heading">{name}</span>
  </h1>
  <h1
    class="text-center font-heading text-neutral-50 text-3xl font-bold leading-tight tracking-tighter md:text-6xl lg:leading-[1.1] md:hidden animate-enter"
  >
  {name}
  </h1>
    <div class="pt-10 flex flex-col items-center md:grid">
      {
        catPosts.map((post) => (
          <PostCard
            data={post.data}
            url={post.slug}
            TagType="h2"
          />
        ))
      }
    </div>
  </section>
</Main>
